<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <link rel="icon" type="image/png" href="icon.png">
  <title>츼lv치nyos szolg치lat</title>
  

  <!-- React + ReactDOM -->
  <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <!-- SheetJS -->
  <script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>

  <style>
    body { font-family: Arial, sans-serif; padding: 20px; }
    table { border-collapse: collapse; width: 100%; margin-top: 20px; }
    td, th { border: 1px solid #000; padding: 4px; font-size: 12px; }
    button { margin-top: 10px; }
  </style>
</head>
<body>
  </script>


  <h2>Beoszt치s az 치lv치nyos szolg치lathoz</h2>
  <div id="root"></div>

  <script type="text/babel">
    function App() {
      const [data, setData] = React.useState([]);

      const colorTemplate = [
        ['rgb(150,150,150)', 'rgb(25,205,25)', 'rgb(0,215,215)','rgb(255,255,180)','rgb(255,255,0)','rgb(240,70,0)'],
        // Add more rows/colors as needed
      ];

      React.useEffect(() => {
        // 游녢 loads "data.xlsx" from the SAME folder as index.html
        fetch("data.xlsx")
          .then(res => res.arrayBuffer())
          .then(ab => {
            const wb = XLSX.read(ab, { type: "array" });
            const ws = wb.Sheets[wb.SheetNames[0]];
            const json = XLSX.utils.sheet_to_json(ws, { header: 1 });
            setData(json);
          })
          .catch(err => console.error("Error loading Excel:", err));
      }, []);

      const handlePrint = () => {
        const tableHtml = document.getElementById("table").outerHTML;
        const win = window.open("", "", "width=800,height=600");
        win.document.write(`
          <html>
            <head>
              <style>
                @page { size: A4 portrait; margin: 10mm; }
                table { border-collapse: collapse; width: 100%; font-size: 12px; }
                td, th { border: 1px solid black; padding: 4px; }
              </style>
            </head>
            <body>${tableHtml}</body>
          </html>
        `);
        win.document.close();
        win.print();
      };

      return (
        <div>
          <button onClick={handlePrint}>Nyomtat치s</button>
          <div id="table">
            <table>
              <tbody>
                {data.map((row, i) => (
                  <tr key={i}>
                    {row.map((cell, j) => (
                      <td key={j} style={{backgroundColor: colorTemplate[i] ? colorTemplate[i][j] : 'white'}}>
                        {cell}
                      </td>
                    ))}
                  </tr>
                ))}
              </tbody>
            </table>
          </div>
        </div>
      );
    }

    const root = ReactDOM.createRoot(document.getElementById("root"));
    root.render(<App />);
  </script>
</body>
</html>

